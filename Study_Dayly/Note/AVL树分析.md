上一篇文章介绍了 map multimap set multiset ，并且提到过 这些容器的 底层都是 **红黑树** 实现的

之前介绍过 什么是二叉搜索树，但是二叉搜索树有一个缺点就是 在特定的情况下插入数据，可能会创建一个单边树。这也是为什么 set 和 map 不使用二叉搜索树，而是用红黑树的原因。

红黑树是平衡二叉搜索树的一种。本篇文章介绍的数据结构 也是一种平衡二叉搜索树，但并不是 红黑树 而是 **AVL树**。

AVL树 是最早被设计出来的平衡二叉搜索树

# 平衡二叉搜索树

关于 平衡二叉搜索树，除了它是二叉搜索树之外，最重要的特点莫过于 平衡 

对二叉树而言 怎么样才算平衡？

平衡树：任意节点的子树的高度差的绝对值都小于等于 1

> 任意节点的子树高度差的绝对值都 <= 1，这句话是什么意思？
>
> 首先要明白 什么是节点的子树的高度差：
>
> <img src="https://dxyt-july-image.oss-cn-beijing.aliyuncs.com/CSDN/202209052035064.png" alt="image-20220905203514009" style="zoom:80%;" />
>
> 以上面这棵二叉树为例：
>
> 1. 对于 3 节点，其左子树的高度为 3，右子树的高度为 2。则可以说，3 节点的子树的高度差 为 -1
> 2. 对于 5 节点，其左子树的高度为 1，右子树的高度为 2。则可以说，5 节点的子树的高度差 为 1
> 3. 对于 2 节点，其左子树的高度为 1，右子树的高度为 1。则可以说，2 节点的子树的高度差 为 0
>
> 也就是说，节点的子树的高度差，可以根绝节点的左右子树的高度来计算，且计算时 左子树高度为负数，右子树高度为正数
>
> 那么可以计算出上面这棵树的所有结点的高度差：
>
> 3：-1；	5：1；	6：0；	2：0；	7：0；	4：0；	1：-1；	0：0；
>
> 所有结点的子树高度差的绝对值都没有大于 1，所以可以说上面这棵树是一颗平衡树

那么 平衡二叉搜索树，就是在此树 满足二叉搜索树的结构规则的前提 下，还要满足平衡

即，一棵树同时满足这两个条件 就可以称此树是平衡二叉搜索树：

1. 任意节点的子树的高度差的绝对值都小于等于 1
2. 任意节点的左孩子恒小于此节点，右孩子恒大于此节点

## AVL 树

### 1. AVL树 的概念

构建二叉搜索树存在一个缺点是 如果数据有序或接近有序 构建二叉搜索树，构建完成时会发现此树为单支树，查找元素相当于在顺序表中查找，时间复杂度接近O(N)

两位俄罗斯的数学家 **G.M.Adelson-Velskii** 和 **E.M.Landis** 发明了一种解决上述问题的方法：**插入数据建立二叉搜索树的同时，通过调整节点关系 使每个结点的左右子树高度差不超过 1，进而建立出平衡二叉搜索树 可降低树的高度，从而减少平均搜索长度**

由 **G.M.Adelson-Velskii** 和 **E.M.Landis** 提出的此方法构建出的 平衡二叉搜索树，就被称为 AVL树

### 2. AVL树 节点的定义

AVL树的是一种三叉链结构，即 每个节点除左右孩子、数据之外，还存有父亲节点

为了方便得出每个节点的子树高度差，所以还可以存储一个变量来记录左右孩子的高度差（平衡因子）

所以 AVL树 的节点结构可以设计 定义为：

<img src="https://dxyt-july-image.oss-cn-beijing.aliyuncs.com/CSDN/202209052153361.png" alt="image-20220905215307309" style="zoom:80%;" />

当然 在节点内存储平衡因子并不是必须的，也可以通过其他方法记录

### 3. AVL树 插入数据

AVL树 是平衡二叉搜索树，建立的过程是 在二叉搜索树的前提下，再调整节点构建出来的

所以 AVL树插入数据的过程可以大致分为两个步骤：

1. 按照二叉搜索树的插入方式插入新节点
2. 分析节点的子树高度差，并进行调整

所以